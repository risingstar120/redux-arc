!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("redux")):"function"==typeof define&&define.amd?define(["exports","redux"],e):e(r.ReduxArc=r.ReduxArc||{},r.Redux)}(this,function(r,e){"use strict";function t(r,e){var t={};for(var n in r)0>e.indexOf(n)&&Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);return t}function n(r,e){return"function"==typeof e.modifier?e.modifier(r):r}function o(r,e){var t={};for(var n in r)0>e.indexOf(n)&&Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);return t}function i(r,e,t){function i(t){var i=n(t,r)||{},u=i.payload,c=o(i,["payload"]),f={type:[e.REQUEST,e.RESPONSE],meta:E({},c,{url:a(r.url,c),method:r.method})};return u&&(f.payload=u),r.meta&&(f.meta=E({},r.meta,f.meta)),r.schema&&(f.meta.schema=r.schema),r.policies&&(f.meta.policies=r.policies),f}return Object.defineProperty(i,"name",{value:t+"_"+e.uppercaseName+" apiCreator",writable:!1}),i}function a(r,e){return r.replace(/(:)([A-Za-z0-9]*)/g,function(t,n,o){var i=typeof e[o];if("string"!==i&&"number"!==i)throw Error("Param "+n+" from url "+r+", not found in params object");return e[o]})}function u(r,e){if(Object.keys(e).forEach(function(t){var n=e[t],o=r+"_"+s(t);if("string"!=typeof n.url)throw Error("Invalid url, "+n.url+", provided for "+o+", it should be a string");if(/:payload*/g.test(n.url))throw Error("Invalid url, "+n.url+", provided for "+o+", you cannot use payload as a param");if("string"!=typeof n.method||!n.method.length)throw Error("Invalid method,  "+n.method+", provided for "+o+", it should be a string");if(n.modifier&&"function"!=typeof n.modifier)throw Error("Invalid modifier handler, "+n.modifier+", provided for "+o+", it should be a function")}),!r||"string"!=typeof r)throw Error("Invalid namespace provided: "+r+", it should be a string")}function c(r,e){return function(t){return function(n){return function(o){t.dispatch({type:r,meta:o.meta});var i=P({payload:o.payload},o.meta);return e({getState:t.getState})(function(r,e){return r?n(o,r,null):n(o,null,e)})(i)}}}}function f(r){return function(e){return function(t,n,o){var i={type:r,meta:t.meta,payload:o};if(n){var a=P({},i,{error:!0});return e.dispatch(a),n}return e.dispatch(i),o}}}var p=Object.assign||function(r){for(var e=1;arguments.length>e;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},s=function(r){return r.replace(/([A-Z])/g,"_$1").toUpperCase()},d=function(r,e){return r.reduce(function(r,t){var n,o=s(t);return p({},r,(n={},n[t]={uppercaseName:o,REQUEST:e+"_"+o+"_REQUEST",RESPONSE:e+"_"+o+"_RESPONSE"},n))},{})},l=function(r,e,t,n){return Object.keys(r).reduce(function(o,i){var a;return p({},o,(a={},a[i]=n(r[i],e[i],t),a))},{})},y=function(r){return Object.keys(r).reduce(function(e,n){var o,i=r[n],a=i.uppercaseName,u=t(i,["uppercaseName"]);return p({},e,(o={},o[a]=u,o))},{})},v={parseToUppercase:s,createTypes:d,parseOptions:n,createCreators:l,reduceActionTypes:y},m=["beforeRequest","onResponse"],h={},b=function(r){return function(t){var n=r.map(function(r){return h[r]}).filter(function(r){return r.applyPoint===t});return function(r){return function(t){var o=n.map(function(e){return e(r)});return e.compose.apply(void 0,o)(t)}}}},O=function(r){if(Array.isArray(r)){var e=Object.keys(h).filter(function(e){return r.indexOf(e)>=0});return b(e)}return b([])},g={globalPolicies:h,register:function(r,e){var t;if(h[r])throw Error("Called register with policy: "+r+" more than once");if(0>m.indexOf(e.applyPoint)){var n="Invalid applyPoint: "+e.applyPoint+", provided with policy: "+r+".",o="The apply points available are: "+m.join(", ");throw Error(n+" "+o)}Object.assign(h,(t={},t[r]=e,t))},getActionPolicies:O,reset:function(){Object.keys(h).forEach(function(r){delete h[r]})}},E=Object.assign||function(r){for(var e=1;arguments.length>e;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},w=function(r){return"string"==typeof r},j=function(r){return 2===r.length&&r.every(w)},P=Object.assign||function(r){for(var e=1;arguments.length>e;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r};r.asyncActionHelpers=v,r.policies=g,r.createApiActions=function(r,e,t){var n=s(r);u(n,e);var o=Object.keys(e),a=d(o,n);return{creators:l(e,a,n,i),types:y(a)}},r.createAsyncMiddleware=function(r){if("function"!=typeof r)throw Error("You must provide a asyncTask function to createAsyncMiddleware, with the following signature:  \n done => (action, error, response) => done(action, error, response)");return function(t){return function(n){return function(o){var i=o.type,a=o.meta;if(!Array.isArray(i))return n(o);if(!j(i))throw Error("Expected type to be an array of two strings, request and response.");if(!a||"object"!=typeof a)throw Error("Expected meta to be an object");var u=O(o.meta.policies),p=o.type,s=p[0],d=p[1],l=[u("beforeRequest"),c(s,r),u("onResponse")].map(function(r){return r(t)}),y=f(d)(t);return e.compose.apply(void 0,l)(y)(o)}}}},Object.defineProperty(r,"__esModule",{value:!0})});
